(this.webpackJsonpspeechstate=this.webpackJsonpspeechstate||[]).push([[0],{170:function(t,e,n){},218:function(t,e){},357:function(t,e){},360:function(t,e){},364:function(t,e){},365:function(t,e){},366:function(t,e){},367:function(t,e){},368:function(t,e){},456:function(t,e,n){"use strict";n.r(e);var r=n(166),o=n(51),c=(n(170),n(14),n(159)),i=n(25),u=n(94),a=n(3),s=n(459),l=n(460);function m(t){return Object(a.q)((function(e){return{type:"SPEAK",value:t}}))}var d={"Lecture.":{title:"Dialogue systems lecture"},"Lunch.":{title:"Lunch at the canteen"},"Dinner.":{title:"Dinner"},"Business.":{title:"Business meeting"},"Study session.":{title:"Study session"},"Walk.":{title:"Walk"},"Language course.":{title:"Language course"},"Programming course.":{title:"Programming course"},"Zoom meeting":{title:"Zoom meeting"},Monday:{title:"Monday"},"Tuesday.":{day:"Tuesday"},"Wednesday.":{day:"Wednesday"},"Thursday.":{day:"Thursday"},Friday:{day:"Friday"},Saturday:{day:"Saturday"},"Sunday.":{day:"Sunday"},"Tomorrow.":{day:"tomorrow"},10:{time:"10"},11:{time:"11 "},12:{time:"12 "},"1.":{time:"1 "},"2.":{time:"2"},"3.":{time:"3 "},"4.":{time:"4 "},"5.":{time:"5 "},"6.":{time:"6 "},"7.":{time:"7 "},"8.":{time:"8 "},"9.":{time:"9"},"At 10":{time:"10"},"At 11":{time:"11"},"At 12":{time:"12"},"At 1:00":{time:"1"},"At 2:00":{time:"2"},"At 3:00":{time:"3"},"At 4:00":{time:"4"},"At 5:00":{time:"5"},"At 6:00":{time:"6"},"At 7:00":{time:"7"},"At 8:00":{time:"8"},"At 9:00":{time:"9"},"At 1:00 PM.":{time:"1"},"At 2:00 PM.":{time:"2"},"At 3:00 PM.":{time:"3"},"At 4:00 PM.":{time:"4"},"At 5:00 PM.":{time:"5"},"At 6:00 PM.":{time:"6"},"At 7:00 PM.":{time:"7"},"At 8:00 PM.":{time:"8"},"At 9:00 PM.":{time:"9"},"At 10:00 PM.":{time:"10"},"At 11:00 PM.":{time:"11"},"At 6:00 AM.":{time:"6"},"At 7:00 AM.":{time:"7"},"At 8:00 AM.":{time:"8"},"At 9:00 AM.":{time:"9"},"At 10:00 AM.":{time:"10"},"At 11:00 AM.":{time:"11"},"At noon":{time:"noon"}},f={"Yes.":{pos:"Yes"},Yes:{pos:"Yes"},"Okay.":{pos:"Yes"},"No.":{neg:"No"},"Of course.":{pos:"Yes"},"No way.":{neg:"No"},"Absolutely not.":{neg:"No"},Absolutely:{pos:"Yes"},Sure:{pos:"Yes"},"Yes please.":{pos:"Yes"},"Help.":{help:"Help"},"I need help.":{help:"Help"},"What do I do?":{help:"Help"}},p={"Create a meeting.":{meet:"Meeting"},"I want to create a meeting.":{meet:"Meeting"},Meeting:{meet:"Meeting"},"Meet a celebrity.":{celeb:"Meet a celebrity"},"Celebrity.":{celeb:"celebrity"},"Search for someone.":{celeb:"Search for someone"},"Search for a celebrity":{celeb:"Search for a celebrity"},"Assistant.":{assistant:"Assistant"},"Intent.":{assistant:"Assistant"},"Do intent.":{assistant:"Assistant"},"Home assistant bot.":{assistant:"Assistant"}},b={"Vacuum.":{intent:"vacuum"},"Move to trash.":{intent:"Throw this in the trash"},Give:{intent:"Give this"},"Turn on the light.":{intent:"Turn on the light"},"Turn on lights":{intent:"Turn on the light"},"Turn off the light.":{intent:"Turn off the light"},"Turn off lights.":{intent:"Turn off the light"},"Turn off the lights.":{intent:"Turn of the light"},"Ask oven warm":{intent:"See if the oven is warm"},"Inform oven warm.":{intent:"Say that oven is warm"}},g=.6,E=Object(a.q)((function(t){return{type:"SPEAK",value:"Did you mean to say ".concat(t.checker,"?")}})),y={initial:"idle",states:{idle:{on:{CLICK:"init"}},init:{on:{TTS_READY:"createAppointment",CLICK:"createAppointment"}},getHelp:{initial:"helpmessage",states:{helpmessage:{entry:m("Listen to the instructions and make sure to speak clearly."),on:{ENDSPEECH:"#root.dm.createAppointment.hist"}}}},noMatch:{entry:m("I didn't understand, could you please repeat that?"),on:{ENDSPEECH:"#root.dm.createAppointment.deeperhist"}},createAppointment:{initial:"hello",states:{hist:{type:"history"},deeperhist:{type:"history",history:"deep"},hello:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"mainmenu",cond:function(t){return t.recResult[0].confidence>g},actions:Object(a.b)({username:function(t){return t.recResult[0].utterance}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{hist:{type:"history"},prompt1:{entry:[m("Hello! What is your username?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[m("Please say your username"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[m("What should I call you?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},mainmenu:{initial:"prompt",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"welcome",cond:function(t){return"meet"in(p[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({meet:function(t){return p[t.recResult[0].utterance].meet}})},{target:"confirm_meeting",cond:function(t){return"meet"in(p[t.recResult[0].utterance]||{})&&t.recResult[0].confidence<g},actions:Object(a.b)({meet:function(t){return p[t.recResult[0].utterance].meet}})},{target:"searchceleb",cond:function(t){return"celeb"in(p[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({celeb:function(t){return p[t.recResult[0].utterance].celeb}})},{target:"confirm_search",cond:function(t){return"celeb"in(p[t.recResult[0].utterance]||{})&&t.recResult[0].confidence<g},actions:Object(a.b)({celeb:function(t){return p[t.recResult[0].utterance].celeb}})},{target:"lookup_intent",cond:function(t){return"assistant"in(p[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({assistant:function(t){return p[t.recResult[0].utterance].assistant}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt",cond:function(t){return 0===t.counter}},{target:".prompt",cond:function(t){return 1===t.counter}},{target:".question_with_instructions",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt:{entry:Object(a.q)((function(t){return{type:"SPEAK",value:"Hi ".concat(t.username)}})),on:{ENDSPEECH:"question"}},question:{entry:[m("What do you want to do?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},question_with_instructions:{entry:[m("You can create a meeting, search for someone or get help from your home assistant bot. What do you want to do?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},confirm_meeting:{initial:"ask_confirm",entry:Object(a.b)({checker:function(t){return t.meet}}),on:{RECOGNISED:[{target:"welcome",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.init",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.noMatch"}]},states:{ask_confirm:{entry:E,on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},confirm_search:{initial:"ask_confirm",entry:Object(a.b)({checker:function(t){return t.celeb}}),on:{RECOGNISED:[{target:"searchceleb",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.init",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.noMatch"}]},states:{ask_confirm:{entry:E,on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},lookup_intent:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"do_intent",cond:function(t){return"intent"in(b[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({intent:function(t){return b[t.recResult[0].utterance].intent}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[m("What can I do for you?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[m("What can I help you with?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[m("What do you need help with?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},do_intent:{initial:"findintent",states:{findintent:{invoke:{id:"findintent",src:function(t,e){return n=t.intent,fetch(new Request("https://intentrecog.herokuapp.com/model/parse",{method:"POST",body:'{"text": "'.concat(n,'"}')})).then((function(t){return t.json()}));var n},onDone:{target:"intentsuccess",actions:Object(a.b)({intent:function(t,e){return e.data.intent.name}})},onError:{target:"intentfailure",actions:Object(a.b)({intent:function(t,e){return e.data.intent.name}})}}},intentsuccess:{entry:Object(a.q)((function(t){return{type:"SPEAK",value:"Ok I will ".concat(t.intent,". Please start the app again if you want me to do something else.")}})),on:{ENDSPEECH:"#root.dm.init"}},intentfailure:{entry:Object(a.q)((function(t){return{type:"SPEAK",value:"Sorry, I can't ".concat(t.intent)}})),on:{ENDSPEECH:"#root.dm.init"}}}},searchceleb:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"testermenu",cond:function(t){return t.recResult[0].confidence>g},actions:Object(a.b)({celeb:function(t){return t.recResult[0].utterance}})},{target:"confirm_celeb",cond:function(t){return t.recResult[0].confidence<g},actions:Object(a.b)({celeb:function(t){return t.recResult[0].utterance}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[m("Who are you searching for?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[m("Please tell me who you are searching for"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[m("Tell me the name of a celebrity and I will look them up for you"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},confirm_celeb:{initial:"ask_confirm",entry:Object(a.b)({checker:function(t){return t.celeb}}),on:{RECOGNISED:[{target:"testermenu",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.init",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.noMatch"}]},states:{ask_confirm:{entry:E,on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},testermenu:{initial:"findcelebrity",states:{findcelebrity:{invoke:{id:"findcelebrity",src:function(t,e){return n=t.celeb,fetch(new Request("https://cors.eu.org/https://api.duckduckgo.com/?q=".concat(n,"&format=json&skip_disambig=1&kl=us_en"))).then((function(t){return t.json()}));var n},onDone:{target:"success",actions:Object(a.b)({title:function(t,e){return"meeting with "+e.data.Heading},snippet:function(t,e){return e.data.AbstractText}})},onError:{target:"#root.dm.createAppointment.searchceleb"}}},success:{entry:Object(a.q)((function(t){return{type:"SPEAK",value:"OK, ".concat(t.snippet)}})),on:{ENDSPEECH:"doyou"}},doyou:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.createAppointment.day",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({pos:function(t){return f[t.recResult[0].utterance].pos}})},{target:"#root.dm.createAppointment.confirm_celebmeet",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})&&t.recResult[0].confidence<g},actions:Object(a.b)({pos:function(t){return f[t.recResult[0].utterance].pos}})},{target:"#root.dm.createAppointment.mainmenu",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({neg:function(t){return f[t.recResult[0].utterance].neg}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[m("Do you want to meet them?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[m("Do you want to meet this celebrity?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[m("Do you want to create a meeting with this person?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}}}},confirm_celebmeet:{initial:"ask_confirm",entry:Object(a.b)({checker:function(t){return t.pos}}),on:{RECOGNISED:[{target:"day",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.init",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.noMatch"}]},states:{ask_confirm:{entry:E,on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},welcome:{entry:Object(a.q)((function(t){return{type:"SPEAK",value:"Let's create a meeting!"}})),on:{ENDSPEECH:"regards"}},regards:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"day",cond:function(t){return"title"in(d[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({title:function(t){return d[t.recResult[0].utterance].title}})},{target:"confirm_regard",cond:function(t){return"title"in(d[t.recResult[0].utterance]||{})&&t.recResult[0].confidence<g},actions:Object(a.b)({title:function(t){return d[t.recResult[0].utterance].title}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[m("What is it about?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[m("What is your meeting about?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[m("What should your meeting be called?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},confirm_regard:{initial:"ask_confirm",entry:Object(a.b)({checker:function(t){return t.title}}),on:{RECOGNISED:[{target:"day",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.init",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.noMatch"}]},states:{ask_confirm:{entry:E,on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},day:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"durance",cond:function(t){return"day"in(d[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({day:function(t){return d[t.recResult[0].utterance].day}})},{target:"confirm_day",cond:function(t){return"day"in(d[t.recResult[0].utterance]||{})&&t.recResult[0].confidence<g},actions:Object(a.b)({day:function(t){return d[t.recResult[0].utterance].day}})},{target:".nomatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[m("On which day is it?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[m("On which day will this meeting take place?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[m("Please tell me the day of this meeting."),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")},nomatch:{entry:m("Sorry, what day did you say?"),on:{ENDSPEECH:"ask"}}}},confirm_day:{initial:"ask_confirm",entry:Object(a.b)({checker:function(t){return t.day}}),on:{RECOGNISED:[{target:"durance",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.init",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.noMatch"}]},states:{ask_confirm:{entry:E,on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},durance:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"creationwholeday",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({pos:function(t){return f[t.recResult[0].utterance].pos}})},{target:"time",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({neg:function(t){return f[t.recResult[0].utterance].neg}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[m("Will it take the whole day?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[m("Will the meeting take the whole day?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[m("Will the meeting take the whole day? You can say 'yes' or 'no'."),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},time:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"creation_with_time",cond:function(t){return"time"in(d[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({time:function(t){return d[t.recResult[0].utterance].time}})},{target:"confirm_time",cond:function(t){return"time"in(d[t.recResult[0].utterance]||{})&&t.recResult[0].confidence<g},actions:Object(a.b)({time:function(t){return d[t.recResult[0].utterance].time}})},{target:".nomatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[m("What time is your meeting?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[m("What time will this meeting be?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[m("At what time will this meeting take place?"),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")},nomatch:{entry:m("Sorry, what time did you say?"),on:{ENDSPEECH:"ask"}}}},confirm_time:{initial:"ask_confirm",entry:Object(a.b)({checker:function(t){return t.time}}),on:{RECOGNISED:[{target:"creation_with_time",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.init",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})}},{target:"#root.dm.noMatch"}]},states:{ask_confirm:{entry:E,on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},creationwholeday:{initial:"prompt1",entry:Object(a.b)({counter:function(t){return t.counter=0}}),on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"info",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({pos:function(t){return f[t.recResult[0].utterance].pos}})},{target:"regards",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})&&t.recResult[0].confidence>g},actions:Object(a.b)({neg:function(t){return f[t.recResult[0].utterance].neg}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[Object(a.q)((function(t){return{type:"SPEAK",value:"Do you want me to create a meeting titled ".concat(t.title," on ").concat(t.day,"?")}})),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[Object(a.q)((function(t){return{type:"SPEAK",value:"Should I create a meeting called ".concat(t.title," on ").concat(t.day,"?")}})),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[Object(a.q)((function(t){return{type:"SPEAK",value:"The information I've gotten is a meeting titled ".concat(t.title," on ").concat(t.day,". Should I create a meeting for that?")}})),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},creation_with_time:{initial:"prompt1",on:{RECOGNISED:[{target:"#root.dm.getHelp",cond:function(t){return"help"in(f[t.recResult[0].utterance]||{})}},{target:"info",cond:function(t){return"pos"in(f[t.recResult[0].utterance]||{})},actions:Object(a.b)({pos:function(t){return f[t.recResult[0].utterance].pos}})},{target:"regards",cond:function(t){return"neg"in(f[t.recResult[0].utterance]||{})},actions:Object(a.b)({neg:function(t){return f[t.recResult[0].utterance].neg}})},{target:"#root.dm.noMatch"}],TIMEOUT:[{target:".prompt1",cond:function(t){return 0===t.counter}},{target:".prompt2",cond:function(t){return 1===t.counter}},{target:".prompt3",cond:function(t){return 2===t.counter}},{target:"#root.dm.init",cond:function(t){return 3===t.counter}}]},states:{prompt1:{entry:[Object(a.q)((function(t){return{type:"SPEAK",value:"Do you want me to create a meeting titled ".concat(t.title," on ").concat(t.day," at ").concat(t.time,"?")}})),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt2:{entry:[Object(a.q)((function(t){return{type:"SPEAK",value:"Should I create a meeting called ".concat(t.title," on ").concat(t.day," at ").concat(t.time,"?")}})),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},prompt3:{entry:[Object(a.q)((function(t){return{type:"SPEAK",value:"The information I have is a meeting titled ".concat(t.title," on ").concat(t.day," at ").concat(t.time,". Should I create that meeting for you?")}})),Object(a.b)({counter:function(t){return t.counter+1}})],on:{ENDSPEECH:"ask"}},ask:{entry:Object(a.q)("LISTEN")}}},info:{entry:Object(a.q)((function(t){return{type:"SPEAK",value:"Your meeting has been created."}})),on:{ENDSPEECH:"#root.dm.init"}}}}}},h=n(160),O=n.n(h),S=n(163),j=n.n(S),R=n(12),k=i.a.send,C=i.a.cancel,N="northeurope";Object(l.a)({url:"https://statecharts.io/inspect",iframe:!1});var T=Object(u.a)({id:"root",type:"parallel",states:{dm:Object(o.a)({},y),asrtts:{initial:"init",states:{init:{on:{CLICK:{target:"getToken",actions:[Object(a.b)({audioCtx:function(t){return new(window.AudioContext||window.webkitAudioContext)}}),function(t){return navigator.mediaDevices.getUserMedia({audio:!0}).then((function(e){t.audioCtx.createMediaStreamSource(e)}))}]}}},getToken:{invoke:{id:"getAuthorizationToken",src:function(t,e){return I()},onDone:{actions:[Object(a.b)((function(t,e){return{azureAuthorizationToken:e.data}})),"ponyfillASR"],target:"ponyfillTTS"},onError:{target:"fail"}}},ponyfillTTS:{invoke:{id:"ponyTTS",src:function(t,e){return function(e,n){var r=j()({audioContext:t.audioCtx,credentials:{region:N,authorizationToken:t.azureAuthorizationToken}}),o=r.speechSynthesis,c=r.SpeechSynthesisUtterance;t.tts=o,t.ttsUtterance=c,t.tts.addEventListener("voiceschanged",(function(){t.tts.cancel();var n=t.tts.getVoices(),r=RegExp("en-US","u");r=RegExp("en-US","u");var o=n.find((function(t){return r.test(t.name)}));o?(t.voice=o,e("TTS_READY")):(console.error("TTS_ERROR: Could not get voice for regexp ".concat(r)),e("TTS_ERROR"))}))}}},on:{TTS_READY:"idle",TTS_ERROR:"fail"}},idle:{on:{LISTEN:"recognising",SPEAK:{target:"speaking",actions:Object(a.b)((function(t,e){return{ttsAgenda:e.value}}))}}},recognising:{initial:"noinput",exit:"recStop",on:{ASRRESULT:{actions:["recLogResult",Object(a.b)((function(t,e){return{recResult:e.value}}))],target:".match"},RECOGNISED:"idle",SELECT:"idle",CLICK:".pause"},states:{noinput:{entry:["recStart",k({type:"TIMEOUT"},{delay:function(t){return 500*(t.tdmPassivity||10)},id:"timeout"})],on:{TIMEOUT:"#root.asrtts.idle",STARTSPEECH:"inprogress"},exit:C("timeout")},inprogress:{},match:{entry:k("RECOGNISED")},pause:{entry:"recStop",on:{CLICK:"noinput"}}}},speaking:{entry:"ttsStart",on:{ENDSPEECH:"idle",SELECT:"idle",CLICK:{target:"idle",actions:k("ENDSPEECH")}},exit:"ttsStop"},fail:{}}}}},{actions:{recLogResult:function(t){console.log("U>",t.recResult[0].utterance,t.recResult[0].confidence)},logIntent:function(t){console.log("<< NLU intent: "+t.nluData.intent.name)}}}),A=function(t){var e=((t.state.context.tdmVisualOutputInfo||[{}]).find((function(t){return"name"===t.attribute}))||{}).value,n=((t.state.context.tdmVisualOutputInfo||[{}]).find((function(t){return"image"===t.attribute}))||{}).value,r="circle";switch(!0){case t.state.matches({asrtts:"fail"})||t.state.matches({dm:"fail"}):break;case t.state.matches({asrtts:{recognising:"pause"}}):e="Click to continue";break;case t.state.matches({asrtts:"recognising"}):r="circle-recognising",e=e||"Listening...";break;case t.state.matches({asrtts:"speaking"}):r="circle-speaking",e=e||"Speaking...";break;case t.state.matches({dm:"idle"}):case t.state.matches({dm:"init"}):e="Click to start!",r="circle-click";break;default:e=e||"\xa0"}return Object(R.jsxs)("div",{className:"control",children:[Object(R.jsx)("figure",{className:"prompt",children:n&&Object(R.jsx)("img",{src:n,alt:e})}),Object(R.jsxs)("div",{className:"status",children:[Object(R.jsx)("button",Object(o.a)({type:"button",className:r,style:{}},t)),Object(R.jsx)("div",{className:"status-text",children:e})]})]})},D=function(t){var e=t.alternative.find((function(t){return"name"===t.attribute})).value,n=(t.alternative.find((function(t){return"image"===t.attribute}))||{}).value;return Object(R.jsxs)("figure",Object(o.a)(Object(o.a)({className:"flex"},t),{},{children:[n&&Object(R.jsx)("img",{src:n,alt:e}),Object(R.jsx)("figcaption",{children:e})]}))};function P(){var t=Object(s.b)(T,{devTools:!0,actions:{changeColour:Object(s.a)((function(t){document.body.style.background=t.recResult[0].utterance})),recStart:Object(s.a)((function(t){t.asr.start()})),recStop:Object(s.a)((function(t){t.asr.abort()})),ttsStart:Object(s.a)((function(t){var e=new t.ttsUtterance(t.ttsAgenda);console.log("S>",t.ttsAgenda),e.voice=t.voice,e.onend=function(){return o("ENDSPEECH")},t.tts.speak(e)})),ttsStop:Object(s.a)((function(t){t.tts.cancel()})),ponyfillASR:Object(s.a)((function(t,e){var n=O()({audioContext:t.audioCtx,credentials:{region:N,authorizationToken:t.azureAuthorizationToken}}).SpeechRecognition;t.asr=new n,t.asr.lang="en-US",t.asr.continuous=!0,t.asr.interimResults=!0,t.asr.onresult=function(t){var e=t.results[0];e.isFinal?o({type:"ASRRESULT",value:[{utterance:e[0].transcript,confidence:e[0].confidence}]}):o({type:"STARTSPEECH"})}}))}}),e=Object(r.a)(t,2),n=e[0],o=e[1],c=(n.context.tdmExpectedAlternatives||[]).filter((function(t){return t.visual_information})).map((function(t,e){return Object(R.jsx)(D,{state:n,alternative:t.visual_information,onClick:function(){return o({type:"SELECT",value:t.semantic_expression})}},e)}));return Object(R.jsxs)("div",{className:"App",children:[Object(R.jsx)(A,{state:n,alternative:{},onClick:function(){return o("CLICK")}}),Object(R.jsx)("div",{className:"select-wrapper",children:Object(R.jsx)("div",{className:"select",children:c})})]})}var I=function(){return fetch(new Request("https://northeurope.api.cognitive.microsoft.com/sts/v1.0/issuetoken",{method:"POST",headers:{"Ocp-Apim-Subscription-Key":"928be3e53ba647f8a9c0129ec3524237"}})).then((function(t){return t.text()}))},v=document.getElementById("root");c.render(Object(R.jsx)(P,{}),v)}},[[456,1,2]]]);
//# sourceMappingURL=main.578045b9.chunk.js.map